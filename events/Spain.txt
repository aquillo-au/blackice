###########################
# Spanish Events
###########################

add_namespace = spain

# Spanish Civil War
country_event = {
	id = spain.1
	title = spain.1.t
	desc = spain.1.d

	picture = GFX_report_event_spain_civil_war

	fire_only_once = yes

	trigger = {
		tag = SPR
		has_defensive_war = no
		NOT = { has_government = fascism }
		NOT = { has_global_flag = scw_over }
		date > 1936.7.15 # Trigger at some point after 1936 elections
	}

	mean_time_to_happen = {
		days = 1	# Historical outbreak time after elections
	}
	
	option = { # Support Nationalists
		name = spain.1.a
		
		trigger = { is_ai = no }
		
		hidden_effect = {
			#set_capital = 176
			
			#start_civil_war = {
			#	ruling_party = fascism
			#	ideology = communism
			#	size = 0.5
			#	capital = 41
			#	states = { 41 165 167 168 172 173 175 }
			#}
			#random_country = {
			#	limit = {
			#		original_tag = SPR
			#		has_government = communism
			#	}
			#	add_ideas = SPR_desperate_defences
			#	add_ideas = neutrality_idea_spr
			#	load_oob = SPR_Civil_War
			#	set_equipment_fraction = 0.45
			#	set_national_unity = 0.75
			#	#country_event = { id = spain.3 days = 1 }
			#	add_popularity = {
			#		ideology = socialism
			#		popularity = 0.35
			#	}
			#}

			country_event = { id = spain.105 }
			
			add_ideas = SPR_desperate_defences
			add_ideas = neutrality_idea_spr
			
			news_event = { hours = 6 id = news.63 }

			set_global_flag = spanish_civil_war

			#set_equipment_fraction = 0.5

			#set_national_unity = 0.75

			#add_ideas = SPA_desperate_defences
			#add_ideas = neutrality_idea_spa

			#add_popularity = {
			#	ideology = fascism
			#	popularity = 1
			#}

			#country_event = { id = spain.2 days = 7 }
			169 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 7183
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1178
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1048
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 879
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 875
					instant_build = yes
				}
			}
			174 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 918
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 4024
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 726
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9699
					instant_build = yes
				}
			}
			171 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11677
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11692
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 758
					instant_build = yes
				}
			}
			173 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9979
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 747
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1192
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 7196
					instant_build = yes
				}
			}
			168 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 10024
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11807
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11884
					instant_build = yes
				}
			}
			176 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11825
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 885
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 884
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3887
					instant_build = yes
				}
			}
			175 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6800
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9778
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9757
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3945
					instant_build = yes
				}
			}
			172 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 740
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 738
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3735
					instant_build = yes
				}
			}
			167 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6906
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 962
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9896
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3873
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6856
					instant_build = yes
				}
			}
			166 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3816
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9813
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11821
					instant_build = yes
				}
			}
			41 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3938
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6914
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 896
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3794
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9767
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3858
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 858
					instant_build = yes
				}
			}
			165 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9764
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6836
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 872
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 897
					instant_build = yes
				}
			}
			170 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6954
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6948
					instant_build = yes
				}
			}
		}
		custom_effect_tooltip = nationalists_chosen
	}
	
	option = { # Support Republicans
		name = spain.1.b
		hidden_effect = {
			#start_civil_war = {
			#	ideology = fascism
			#	size = 0.5
			#	capital = 176
			#	states = { 166 699 178 290 169 170 176 174 171 177 297 }
			#}
			country_event = { id = spain.105 }
			
			#random_country = {
			#	limit = {
			#		original_tag = SPR
			#		has_government = fascism
			#	}
			#	add_ideas = SPA_desperate_defences
			#	add_ideas = neutrality_idea_spa

			#	set_equipment_fraction = 0.5
			#	set_national_unity = 0.75
			#	#country_event = { id = spain.2 days = 1 }
			#	load_oob = SPA_Civil_War
			#}
			
			news_event = { hours = 6 id = news.63 }
			
			set_global_flag = spanish_civil_war
			
			set_politics = {
				ruling_party = communism
				elections_allowed = no
			}
			add_popularity = {
				ideology = communism
				popularity = 0.5
			}
			add_popularity = {
				ideology = fascism
				popularity = -1
			}
			
			add_ideas = SPR_desperate_defences
			add_ideas = neutrality_idea_spr
		
			#set_equipment_fraction = 0.45
			set_national_unity = 0.75
			
			#country_event = { id = spain.3 days = 7 }
			169 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 7183
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1178
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1048
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 879
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 875
					instant_build = yes
				}
			}
			174 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 918
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 4024
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 726
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9699
					instant_build = yes
				}
			}
			171 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11677
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11692
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 758
					instant_build = yes
				}
			}
			173 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9979
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 747
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1192
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 7196
					instant_build = yes
				}
			}
			168 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 10024
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11807
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11884
					instant_build = yes
				}
			}
			176 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11825
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 885
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 884
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3887
					instant_build = yes
				}	
			}
			175 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6800
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9778
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9757
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3945
					instant_build = yes
				}
			}
			172 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 740
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 738
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3735
					instant_build = yes
				}
			}
			167 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6906
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 962
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9896
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3873
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6856
					instant_build = yes
				}
			}
			166 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3816
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9813
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11821
					instant_build = yes
				}
			}	
			41 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3938
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6914
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 896
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3794
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9767
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3858
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 858
					instant_build = yes
				}
			}
			165 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9764
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6836
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 872
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 897
					instant_build = yes
				}
			}
			170 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6954
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6948
					instant_build = yes
				}
			}
			custom_effect_tooltip = republicans_chosen
		}
	}
}
# Nationalists: Seek Support
country_event = {
	id = spain.2
	title = spain.2.t
	desc = spain.2.d
	picture = GFX_report_event_nationalist_volunteers
	
	is_triggered_only = yes

	trigger = {
		tag = SPA
		OR = {
			has_global_flag = spanish_civil_war
			has_civil_war = yes
		}
	}

	option = {
		name = spain.2.a
		
		every_country = {
			limit = {
				has_government = fascism
				NOT = { tag = SPA }
			}
			country_event = { id = spain.4 days = 1 }
		}
		if = {
			limit = {
				POR = { NOT = { has_government = communism } }
			}
			POR = { country_event = { id = spain.4 days = 1 } }
		}
	}

	option = {
		name = spain.2.b
		
		add_political_power = 40
		
		ai_chance = { factor = 0 }
	}
}
# Republicans: Seek Support
country_event = {
	id = spain.3
	title = spain.2.t
	desc = spain.3.d
	picture = GFX_report_event_spain_civil_war_volunteers
	
	is_triggered_only = yes

	trigger = {
		tag = SPR
		OR = {
			has_global_flag = spanish_civil_war
			has_civil_war = yes
		}
	}

	option = {
		name = spain.3.a
		every_country = {
			limit = {
				has_government = communism
				NOT = { tag = SPR }
			}
			country_event = { id = spain.5 days = 1 }
		}
		if = {
			limit = {
				MEX = { NOT = { has_government = fascism } }
			}
			MEX = { country_event = { id = spain.5 days = 1 } }
		}
	}

	option = {
		name = spain.3.b
		add_political_power = 40
		ai_chance = { factor = 0 }
	}
}
# Nationalist Spain Wants Our Help
country_event = {
	id = spain.4
	title = spain.4.t
	desc = spain.4.d
	picture = GFX_report_event_franco
	
	is_triggered_only = yes

	trigger = {
		tag = SPA
		OR = {
			has_global_flag = spanish_civil_war
			has_civil_war = yes
		} 
	}

	option = {
		name = spain.4.a
		set_country_flag = promised_help_nationalist_spain
		custom_effect_tooltip = spain.4.a.tt
	}

	option = {
		name = spain.4.b
	}
}

# Republican Spain Wants Our Help
country_event = {
	id = spain.5
	title = spain.5.t
	desc = spain.5.d
	picture = GFX_report_event_spain_civil_war_volunteers
	
	is_triggered_only = yes

	trigger = {
		tag = SPR 
		OR = {
			has_global_flag = spanish_civil_war
			has_civil_war = yes
		} 
	}

	option = {
		name = spain.5.a
		set_country_flag = promised_help_republican_spain
		custom_effect_tooltip = spain.4.a.tt
	}

	option = {
		name = spain.5.b
	}
}

# Nationalist Spain Appreciates our Help
country_event = {
	id = spain.6
	title = spain.6.t
	desc = spain.6.d
	picture = GFX_report_event_franco
	
	trigger = {
		has_country_flag = promised_help_nationalist_spain
		OR = {
			has_global_flag = spanish_civil_war
			has_civil_war = yes
		} 
		any_other_country = {
			tag = SPA
			has_government = fascism
			ROOT = { is_lend_leasing = PREV }
		}
	}

	mean_time_to_happen = {
		days = 2
	}

	option = {
		name = spain.6.a
		
		clr_country_flag = promised_help_nationalist_spain
		random_country = {
			limit = {
				tag = SPA
				has_government = fascism
			}
			add_opinion_modifier = {
				target = ROOT
				modifier = lend_leased_spanish_civil_war
			}
		}
	}
}
# Republican Spain Appreciates our Help
country_event = {
	id = spain.7
	title = spain.7.t
	desc = spain.7.d
	picture = GFX_report_event_spain_civil_war_volunteers
	
	trigger = {
		has_country_flag = promised_help_republican_spain
		OR = {
			has_global_flag = spanish_civil_war
			has_civil_war = yes
		}
		is_lend_leasing = SPR
	}

	mean_time_to_happen = {
		days = 2
	}

	option = {
		name = spain.7.a
		clr_country_flag = promised_help_republican_spain
		SPR = { 
			add_opinion_modifier = {
				target = ROOT
				modifier = lend_leased_spanish_civil_war
			}
		}
	}
}
# Civil war over. Move Capital
country_event = {
	id = spain.8
	title = spain.8.t
	desc = spain.8.d
	picture = GFX_report_event_generic_city
	
	trigger = {
		tag = SPA
		has_government = fascism
		has_global_flag = nationalist_victory
		owns_state = 41
	}

	fire_only_once = yes

	mean_time_to_happen = {
		days = 2
	}

	option = {
		ai_chance = { factor = 10 }
		name = spain.8.a
		set_capital = 41
		add_ideas = neutrality_idea
	}
	
	option = {
		ai_chance = { factor = 0 }
		name = spain.8.b
	}
}
# Election of 1936
country_event = {
	id = spain.9
	title = spain.9.t
	desc = spain.9.d
	picture = GFX_report_event_vote

	fire_only_once = yes

	trigger = {
		tag = SPR
		date > 1936.2.15
		date < 1936.2.17  #1936.2.16
	}
	
	mean_time_to_happen = { days = 1 }
	# Popular Front
	option = {
		name = spain.9.a
		
		add_popularity = {
			ideology = communism
			popularity = 0.1
		}
		set_country_flag = SPA_fascist_civil_war
		
		ai_chance = { factor = 10 }
	}
	# Falange
	option = {
		name = spain.9.b
		
		set_politics = {
			ruling_party = fascism
			elections_allowed = no
		}
		set_country_flag = SPR_communist_civil_war
		
		ai_chance = { factor = 0 }
	}
}
# Spanish Civil War if Franco is elected
country_event = {
	id = spain.10
	title = spain.1.t
	desc = spain.10.d
	picture = GFX_report_event_franco
	
	fire_only_once = yes
	
	trigger = {
		NOT = { has_global_flag = scw_over }
		has_country_flag = SPR_communist_civil_war
		has_defensive_war = no
		date > 1936.7.15 # Trigger at some point after 1936 elections
	}

	mean_time_to_happen = {
		days = 1	# Historical outbreak time after elections
	}
	
	option = { # Support Nationalists
		name = spain.10.a
		trigger = { is_ai = no }
		hidden_effect = {
			#set_capital = 176
			
			#start_civil_war = {
			#	ruling_party = fascism
			#	ideology = communism
			#	size = 0.5
			#	capital = 41
			#	states = { 41 165 167 168 172 173 175 }
			#}
			
			country_event = { id = spain.105 }
			#random_country = {
			#	limit = {
			#		original_tag = SPR
			#		has_government = communism
			#	}
			#	add_ideas = SPR_desperate_defences
			#	add_ideas = neutrality_idea_spr
				
			#	load_oob = SPR_Civil_War
			#	set_equipment_fraction = 0.45
			#	set_national_unity = 0.75
			#	#country_event = { id = spain.3 days = 1 }
			#	add_popularity = {
			#		ideology = socialism
			#		popularity = 0.35
			#	}
			#}
			
			add_ideas = SPR_desperate_defences
			add_ideas = neutrality_idea_spr
			
			news_event = { hours = 6 id = news.63 }
			
			set_global_flag = spanish_civil_war
			
			#set_equipment_fraction = 0.5
			#
			#set_national_unity = 0.75
			#
			#add_ideas = SPA_desperate_defences
			#add_ideas = neutrality_idea_spa

			#add_popularity = {
			#	ideology = fascism
			#	popularity = 1
			#}

			#country_event = { id = spain.2 days = 7 }
			169 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 7183
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1178
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1048
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 879
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 875
					instant_build = yes
				}
			}
			174 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 918
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 4024
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 726
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9699
					instant_build = yes
				}
			}
			171 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11677
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11692
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 758
					instant_build = yes
				}
			}
			173 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9979
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 747
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1192
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 7196
					instant_build = yes
				}
			}
			168 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 10024
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11807
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11884
					instant_build = yes
				}
			}
			176 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11825
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 885
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 884
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3887
					instant_build = yes
				}
			}
			175 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6800
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9778
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9757
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3945
					instant_build = yes
				}
			}
			172 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 740
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 738
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3735
					instant_build = yes
				}
			}
			167 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6906
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 962
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9896
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3873
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6856
					instant_build = yes
				}
			}
			166 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3816
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9813
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11821
					instant_build = yes
				}
			}
			41 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3938
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6914
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 896
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3794
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9767
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3858
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 858
					instant_build = yes
				}
			}
			165 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9764
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6836
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 872
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 897
					instant_build = yes
				}
			}
			170 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6954
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6948
					instant_build = yes
				}
			}
		}
		custom_effect_tooltip = nationalists_chosen
	}
	
	option = { # Support Republicans
		name = spain.10.b
		hidden_effect = {
			#start_civil_war = {
			#	ideology = fascism
			#	size = 0.5
			#	capital = 176
			#	states = { 166 699 178 290 169 170 176 174 171 177 297 }
			#}
			
			country_event = { id = spain.105 }
			#random_country = {
			#	limit = {
			#		original_tag = SPR
			#		has_government = fascism
			#	}
			#	add_ideas = SPA_desperate_defences
			#	add_ideas = neutrality_idea_spa

			#	set_equipment_fraction = 0.5
			#	set_national_unity = 0.75
			#	#country_event = { id = spain.2 days = 1 }
			#	load_oob = SPA_Civil_War
			#}
			
			news_event = { hours = 6 id = news.63 }
			
			set_global_flag = spanish_civil_war
			
			set_politics = {
				ruling_party = communism
				elections_allowed = no
			}
			add_popularity = {
				ideology = communism
				popularity = 0.5
			}
			add_popularity = {
				ideology = fascism
				popularity = -1
			}
			
			add_ideas = SPR_desperate_defences
			add_ideas = neutrality_idea_spr
		
			#set_equipment_fraction = 0.45
			set_national_unity = 0.75
			
			#country_event = { id = spain.3 days = 7 }
			169 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 7183
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1178
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1048
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 879
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 875
					instant_build = yes
				}
			}
			174 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 918
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 4024
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 726
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9699
					instant_build = yes
				}
			}
			171 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11677
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11692
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 758
					instant_build = yes
				}
			}
			173 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9979
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 747
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 1192
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 7196
					instant_build = yes
				}
			}
			168 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 10024
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11807
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11884
					instant_build = yes
				}
			}
			176 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11825
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 885
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 884
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3887
					instant_build = yes
				}	
			}
			175 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6800
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9778
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9757
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3945
					instant_build = yes
				}
			}
			172 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 740
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 738
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3735
					instant_build = yes
				}
			}
			167 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6906
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 962
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9896
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3873
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6856
					instant_build = yes
				}
			}
			166 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3816
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9813
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 11821
					instant_build = yes
				}
			}	
			41 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3938
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6914
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 896
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3794
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9767
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 3858
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 858
					instant_build = yes
				}
			}
			165 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 9764
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6836
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 872
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 897
					instant_build = yes
				}
			}
			170 = {
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6954
					instant_build = yes
				}
				add_building_construction = {
					type = pillbox
					level = 1
					province = 6948
					instant_build = yes
				}
			}
			custom_effect_tooltip = republicans_chosen
		}
	}
}

country_event = {
	id = spain.11
	title = spain.11.t
	desc = spain.11.d
	picture = GFX_report_event_spanish_parade
	
	trigger = {
		OR = {
			tag = SPR
			tag = SPA
		}
		OR = {
			date > 1938.1.1
			has_global_flag = scw_over
		}
		is_ai = yes
	}

	fire_only_once = yes

	mean_time_to_happen = {
		days = 1
	}

	option = {
		ai_chance = { factor = 1 }
		name = spain.11.a
		
		add_ideas = neutrality_idea
	}
}
################# Spanish partisans
country_event = {
	id = spain.12
	title = spain.12.t
	desc = spain.12.d
	picture = GFX_report_event_spain_civil_war_volunteers_01
	
	fire_only_once = yes
	
	trigger = {
		tag = SPR
		NOT = { has_global_flag = scw_over }
		#has_country_flag = impossible
		is_ai = yes
		OR = {
			has_global_flag = spanish_civil_war
			has_civil_war = yes
		}
		#has_global_flag = yes_partisans
	}

	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = spain.12.a
		ai_chance = { factor = 100 }
		set_technology = { partisans = 1 }
		set_country_flag = SPR_partisan_uprisings 
		hidden_effect = {
			set_province_controller = 3744
			set_province_controller = 11692
			set_province_controller = 920
			set_province_controller = 7068
			set_province_controller = 6866

			load_oob = "SPR_Partisans"	#template only
		}
	}
}
country_event = {
	id = spain.13
	title = spain.13.t
	desc = spain.13.d
	picture = GFX_report_event_spain_civil_war_volunteers_01

	trigger = {
		tag = SPA
		NOT = { has_global_flag = scw_over }
		is_ai = yes
		OR = {
			has_global_flag = spanish_civil_war
			has_civil_war = yes
		}
		#has_country_flag = impossible 
		#has_global_flag = yes_partisans
	}
	fire_only_once = yes
		
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = spain.13.a
		ai_chance = { factor = 100 }
		set_technology = { partisans = 1 }
		set_country_flag = SPA_partisan_uprisings 
		hidden_effect = {
			set_province_controller = 1093
			set_province_controller = 3909
			set_province_controller = 11863
			set_province_controller = 11779
			set_province_controller = 11821

			load_oob = "SPA_Partisans"		#template
		}
	}

}
country_event = {
	id = spain.14
	title = spain.14.t
	desc = spain.14.d
	picture = GFX_report_event_spain_civil_war_volunteers_01

	trigger = {
		tag = SPR
		NOT = { has_global_flag = scw_over }
		is_ai = yes
		#has_global_flag = yes_partisans
		has_country_flag = SPR_partisan_uprisings 
		NOT = { has_idea = SPR_partisan_attacks }
	}
	
	immediate = {
		add_timed_idea = {
			idea = SPR_partisan_attacks
			days = 90
		}
	}
	
	mean_time_to_happen = {
		days = 16
	}
	
	option = {
		name = spain.14.a
		
		hidden_effect = {
			set_province_controller = 3744
			set_province_controller = 11692
			set_province_controller = 920
			set_province_controller = 7068
			set_province_controller = 6866
			
			load_oob = "SPR_Partisans_I"
		}
		ai_chance = { factor = 100 }
	}
}

country_event = {
	id = spain.15
	title = spain.15.t
	desc = spain.15.d
	picture = GFX_report_event_spain_civil_war_volunteers_01

	trigger = {
		tag = SPA
		NOT = { has_global_flag = scw_over }
		is_ai = yes
		#has_global_flag = yes_partisans
		has_country_flag = SPA_partisan_uprisings 
		NOT = { has_idea = SPA_partisan_attacks }
	}
	
	immediate = {
		add_timed_idea = {
			idea = SPA_partisan_attacks
			days = 90
		}
	}
	
	mean_time_to_happen = {
		days = 16
	}
	
	option = {
		name = spain.15.a

		hidden_effect = {
			set_province_controller = 1093
			set_province_controller = 3909
			set_province_controller = 11863
			set_province_controller = 11779
			set_province_controller = 11821

			load_oob = "SPA_Partisans_I"
		}
		
		ai_chance = { factor = 100 }
	}
}
######Moroccan Army Corps
country_event = {
	id = spain.16
	title = spain.16.t
	desc = spain.16.d
	picture = GFX_report_event_spain_civil_war_volunteers_01

	trigger = {
		tag = SPA
		NOT = { has_global_flag = scw_over }
		is_ai = yes
		not = { has_country_flag = SPA_partisan_attacks }
		has_country_flag = SPA_partisan_uprisings 
	}
	
	fire_only_once = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = spain.16.a

		hidden_effect = {
			set_province_controller = 1048
			load_oob = "SPA_Moroccan_Army_Corps"
		}
		ai_chance = { factor = 100 }
	}
}
# Alphonse XIII dies
country_event = {
	id = spain.100
	title = spain.100.t
	desc = spain.100.d
	picture = GFX_report_event_generic_funeral

	fire_only_once = yes

	trigger = {
		OR = {
			tag = SPR
			tag = SPA
		}
		OR = {
			has_government = monarchism
			AND = {
				OR = {
					has_government = conservatism
					has_government = socialism
					has_government = liberalism
				}
				has_country_flag = const_king
			}
		}
		date > 1941.1.1
	}
	
	immediate = { set_country_flag = alfonso_dead }
	
	mean_time_to_happen = {
		days = 90
		modifier = {
			factor = 0.7
			date > 1941.2.20
		}
	}

	option = {
		name = spain.100.a
		kill_country_leader = yes
		remove_ideas = alfonso_xiii
		add_ideas = juan_iii
		
		create_country_leader = {
			name = "Juan III"
			desc = "King of Spain"
			picture = "gfx/leaders/SPR/SPR_Portrait_juan_iii.dds"
			expire = "1993.6.4"
			ideology = absolutism
			traits = {
				monarchist
				effective_leader
			}
		}
	}
}

country_event = {
	id = spain.101
	title = spain.101.t
	desc = spain.101.d
	picture = GFX_report_event_spanish_parade

	fire_only_once = yes

	trigger = {
		tag = SPA
		NOT = { has_global_flag = scw_over }
		#is_ai = yes
		date > 1939.1.1
		OR = {
			NOT = { controls_state = 41 } 
			surrender_progress > 0.55
		}
	}
	
	mean_time_to_happen = {
		days = 15
	}
	
	immediate = {
	}
	
	option = {
		name =spain.101.a

		add_national_unity = -0.25
	}
}

country_event = {
	id = spain.102
	title = spain.102.t
	desc = spain.102.d
	picture = GFX_report_event_spanish_parade

	fire_only_once = yes

	trigger = {
		tag = SPA
		NOT = { has_global_flag = scw_over }
		#is_ai = yes
		date > 1939.1.1
		OR = {
			
			NOT = { controls_state = 41 } 
			surrender_progress > 0.7
		}
	}
	
	mean_time_to_happen = {
		days = 90
	}
	
	immediate = {
	}
	
	option = {
		name = spain.102.a

		add_national_unity = -0.25
	}
}

country_event = {
	id = spain.103
	title = spain.103.t
	desc = spain.103.d
	picture = GFX_report_event_spanish_parade

	fire_only_once = yes

	trigger = {
		tag = SPR
		NOT = { has_global_flag = scw_over }
		#is_ai = yes
		date > 1939.1.1
		OR = {
			NOT = { controls_state = 41 } 
			surrender_progress > 0.55
		}
	}
	
	mean_time_to_happen = {
		days = 15
	}
	
	
	option = {
		name =spain.103.a

		add_national_unity = -0.25
	}
}

country_event = {
	id = spain.104
	title = spain.104.t
	desc = spain.104.d
	picture = GFX_report_event_spanish_parade

	fire_only_once = yes

	trigger = {
		tag = SPR
		NOT = { has_global_flag = scw_over }
		date > 1939.1.1
		OR = {
			
			NOT = { controls_state = 41 } 
			surrender_progress > 0.7
		}
	}
	
	mean_time_to_happen = {
		days = 90
	}
	
	
	option = {
		name =spain.104.a

		add_national_unity = -0.25
	}
}
#################################################
#Nationalist Spain
#################################################
country_event = {
	id = spain.105
	title = spain.105.t
	desc = spain.105.d
	picture = GFX_report_event_franco

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name =spain.105.a
		SPA = { set_country_flag = Natspaindow }
		SPA = { 
			add_manpower = 300000
			add_political_power = 600
		
			if = {
				limit = { 
					SPR = { 
						controls_state = 41
						controls_state = 165
						controls_state = 166
						controls_state = 167
						controls_state = 168
						controls_state = 169
						controls_state = 170
						controls_state = 171
						controls_state = 172
						controls_state = 173
						controls_state = 174
						controls_state = 175
						controls_state = 176
						controls_state = 177
						controls_state = 178
						controls_state = 290
						controls_state = 297
						controls_state = 699
					} 
				}
				transfer_state = 166
				transfer_state = 169
				transfer_state = 170
				transfer_state = 171
				transfer_state = 174
				transfer_state = 176
				transfer_state = 178
				transfer_state = 290
				transfer_state = 699
				
				41 = { add_core_of = SPA}
				165 = { add_core_of = SPA}
				166 = { add_core_of = SPA}
				167 = { add_core_of = SPA}
				168 = { add_core_of = SPA}
				169 = { add_core_of = SPA}
				170 = { add_core_of = SPA}
				171 = { add_core_of = SPA}
				172 = { add_core_of = SPA}
				173 = { add_core_of = SPA}
				174 = { add_core_of = SPA}
				175 = { add_core_of = SPA}
				176 = { add_core_of = SPA}
				177 = { add_core_of = SPA}
				178 = { add_core_of = SPA}
				290 = { add_core_of = SPA}
				297 = { add_core_of = SPA}
				699 = { add_core_of = SPA}
			}
			hidden_effect = {
				load_oob = SPA_Civil_War
				
				set_national_unity = 0.50
			}
		}

		SPA = {
			add_ideas = SPA_desperate_defences
			add_ideas = neutrality_idea_spa
		}
		#declare_war_on = {
		#	target = SPA
		#	type = annex_everything
		#}
		SPA = { 
			declare_war_on = {
				target = SPR
				type = annex_everything
			}
		}
		SPR = { declare_war_on = {
				target = SPA
				type = annex_everything
			
					}
		}
		#country_event = { id = spain.106  }
	}
}

country_event = {
	id = spain.106
	title = spain.106.t
	desc = spain.106.d
	picture = GFX_report_event_spanish_parade

	fire_only_once = yes

	trigger = {
		tag = SPR
		NOT = { has_global_flag = scw_over }
		SPA = { has_country_flag = Natspaindow }
		is_ai = yes
	}
	
	mean_time_to_happen = {
		days = 30
	}
	
	option = {
		name =spain.106.a
		set_country_flag = Repspaindow
		SPA = {
			hidden_effect = { load_oob = SPA_Civil_War 	
				
			}
		}
		
			
			699 = { add_core_of = SPR }
			178 = { add_core_of = SPR }
			290 = { add_core_of = SPR }
			297 = { add_core_of = SPR }				
		
		#	hidden_effect = {
		#		load_oob = SPR_Civil_War
		#	}
		
		country_event = { id = spain.107 days = 90 }
	}
}
country_event = {
	id = spain.107
	title = spain.107.t
	desc = spain.107.d
	picture = GFX_report_event_spanish_parade

	fire_only_once = yes

	trigger = {
		tag = SPR
		NOT = { has_global_flag = scw_over }
		has_country_flag = Repspaindow 
		is_ai = yes
	}
	
	mean_time_to_happen = {
		days = 90
	}
	
	option = {
		name =spain.107.a
		
		SPA = {
			hidden_effect = { load_oob = "SPA_1936" 
				
			}
		}
		SPR = {
			hidden_effect = { 
				set_province_controller = 6906
				set_province_controller = 9764
				set_province_controller = 3938
				set_province_controller = 740
			load_oob = SPR_Civil_War 
				
			}
		}
	}
}
### EOF ###