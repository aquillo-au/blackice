scripted_gui = {

	storage = {
		context_type = player_context
		
		parent_window_token = top_bar
		window_name = "storage_container"
		
		visible = {
            always = yes
		}

		effects = {
            buy_icon_click = {
				set_variable = { show_storage = 1 }
			}
		}
	}
	
	storage_menu = {
		context_type = player_context
		
		window_name = "storage_menu_container"
		visible = {
			check_variable = { show_storage > 0 }
		}
		
		effects = {
			exitbutton_click = {
				set_variable = { show_storage = 0 }
			}
			oil_icon_click = {
			if = {
				limit = {
					has_country_flag = stop_oil_storing
					check_variable = { oil > 0 }
				}
				clr_country_flag = stop_oil_storing
			}
			else_if = {
				limit = {
					NOT = { has_country_flag = stop_oil_storing }
					check_variable = { oil > 0 }
				}
				set_country_flag = stop_oil_storing
				clr_country_flag = stop_oil_deploy
			}
			
			
			if = {
				limit = {
					check_variable = { oil < 0 }
					check_variable = { oil_storage > 0.99 }
					check_variable = { oil_deploy_consume > -1 }
					NOT = { has_country_flag = stop_oil_deploy }
				}
				set_country_flag = stop_oil_deploy
				clr_country_flag = stop_oil_storing
			}
			else_if = {
				limit = {
					check_variable = { oil < 0 }
					check_variable = { oil_storage > 0.99 }
					check_variable = { oil_deploy_consume > -1 }
					has_country_flag = stop_oil_deploy
				}
				clr_country_flag = stop_oil_deploy
			}
			}
			rubber_icon_click = {
			if = {
				limit = {
					has_country_flag = stop_rubber_storing
					check_variable = { rubber > 0 }
				}
				clr_country_flag = stop_rubber_storing
			}
			else_if = {
				limit = {
					NOT = { has_country_flag = stop_rubber_storing }
					check_variable = { rubber > 0 }
				}
				set_country_flag = stop_rubber_storing
				clr_country_flag = stop_rubber_deploy
			}
			
			
			if = {
				limit = {
					check_variable = { rubber < 0 }
					check_variable = { rubber_storage > 0.99 }
					check_variable = { rubber_deploy_consume > -1 }
					NOT = { has_country_flag = stop_rubber_deploy }
				}
				set_country_flag = stop_rubber_deploy
				clr_country_flag = stop_rubber_storing
			}
			else_if = {
				limit = {
					check_variable = { rubber < 0 }
					check_variable = { rubber_storage > 0.99 }
					check_variable = { rubber_deploy_consume > -1 }
					has_country_flag = stop_rubber_deploy
				}
				clr_country_flag = stop_rubber_deploy
			}
		}
		steel_icon_click = {
			if = {
				limit = {
					has_country_flag = stop_steel_storing
					check_variable = { steel > 0 }
				}
				clr_country_flag = stop_steel_storing
			}
			else_if = {
				limit = {
					NOT = { has_country_flag = stop_steel_storing }
					check_variable = { steel > 0 }
				}
				set_country_flag = stop_steel_storing
				clr_country_flag = stop_steel_deploy
			}
			
			
			if = {
				limit = {
					check_variable = { steel < 0 }
					check_variable = { steel_storage > 0.99 }
					check_variable = { steel_deploy_consume > -1 }
					NOT = { has_country_flag = stop_steel_deploy }
				}
				set_country_flag = stop_steel_deploy
				clr_country_flag = stop_steel_storing
			}
			else_if = {
				limit = {
					check_variable = { steel < 0 }
					check_variable = { steel_storage > 0.99 }
					check_variable = { steel_deploy_consume > -1 }
					has_country_flag = stop_steel_deploy
				}
				clr_country_flag = stop_steel_deploy
			}
		}
		aluminum_icon_click = {
			if = {
				limit = {
					has_country_flag = stop_aluminium_storing
					check_variable = { aluminium > 0 }
				}
				clr_country_flag = stop_aluminium_storing
			}
			else_if = {
				limit = {
					NOT = { has_country_flag = stop_aluminium_storing }
					check_variable = { aluminium > 0 }
				}
				set_country_flag = stop_aluminium_storing
				clr_country_flag = stop_aluminium_deploy
			}
			
			
			if = {
				limit = {
					check_variable = { aluminium < 0 }
					check_variable = { aluminium_storage > 0.99 }
					check_variable = { aluminium_deploy_consume > -1 }
					NOT = { has_country_flag = stop_aluminium_deploy }
				}
				set_country_flag = stop_aluminium_deploy
				clr_country_flag = stop_aluminium_storing
			}
			else_if = {
				limit = {
					check_variable = { aluminium < 0 }
					check_variable = { aluminium_storage > 0.99 }
					check_variable = { aluminium_deploy_consume > -1 }
					has_country_flag = stop_aluminium_deploy
				}
				clr_country_flag = stop_aluminium_deploy
			}
		}
		tungsten_icon_click = {
			if = {
				limit = {
					has_country_flag = stop_tungsten_storing
					check_variable = { tungsten > 0 }
				}
				clr_country_flag = stop_tungsten_storing
			}
			else_if = {
				limit = {
					NOT = { has_country_flag = stop_tungsten_storing }
					check_variable = { tungsten > 0 }
				}
				set_country_flag = stop_tungsten_storing
				clr_country_flag = stop_tungsten_deploy
			}
			
			
			if = {
				limit = {
					check_variable = { tungsten < 0 }
					check_variable = { tungsten_storage > 0.99 }
					check_variable = { tungsten_deploy_consume > -1 }
					NOT = { has_country_flag = stop_tungsten_deploy }
				}
				set_country_flag = stop_tungsten_deploy
				clr_country_flag = stop_tungsten_storing
			}
			else_if = {
				limit = {
					check_variable = { tungsten < 0 }
					check_variable = { tungsten_storage > 0.99 }
					check_variable = { tungsten_deploy_consume > -1 }
					has_country_flag = stop_tungsten_deploy
				}
				clr_country_flag = stop_tungsten_deploy
			}
		}
		chromium_icon_click = {
			if = {
				limit = {
					has_country_flag = stop_chromium_storing
					check_variable = { chromium > 0 }
				}
				clr_country_flag = stop_chromium_storing
			}
			else_if = {
				limit = {
					NOT = { has_country_flag = stop_chromium_storing }
					check_variable = { chromium > 0 }
				}
				set_country_flag = stop_chromium_storing
				clr_country_flag = stop_chromium_deploy
			}
			
			
			if = {
				limit = {
					check_variable = { chromium < 0 }
					check_variable = { chromium_storage > 0.99 }
					check_variable = { chromium_deploy_consume > -1 }
					NOT = { has_country_flag = stop_chromium_deploy }
				}
				set_country_flag = stop_chromium_deploy
				clr_country_flag = stop_chromium_storing
			}
			else_if = {
				limit = {
					check_variable = { chromium < 0 }
					check_variable = { chromium_storage > 0.99 }
					check_variable = { chromium_deploy_consume > -1 }
					has_country_flag = stop_chromium_deploy
				}
				clr_country_flag = stop_chromium_deploy
			}
		}
		
		}
		triggers = {
			storage_status_headline_visible = {
				OR = {
					check_variable = { daily_deploy_oil > 0 } 
					check_variable = { daily_deploy_rubber > 0 }
					check_variable = { daily_deploy_chromium > 0 } 
					check_variable = { daily_deploy_steel > 0 } 
					check_variable = { daily_deploy_tungsten > 0 } 
					check_variable = { daily_deploy_aluminium > 0 } 
				}
			}
			oil_daily_headline_visible = {
				check_variable = { daily_deploy_oil > 0 } 
			}
			rubber_daily_headline_visible = {
				check_variable = { daily_deploy_rubber > 0 } 
			}
			chromium_daily_headline_visible = {
				check_variable = { daily_deploy_chromium > 0 } 
			}
			steel_daily_headline_visible = {
				check_variable = { daily_deploy_steel > 0 } 
			}
			tungsten_daily_headline_visible = {
				check_variable = { daily_deploy_tungsten > 0 } 
			}
			aluminium_daily_headline_visible = {
				check_variable = { daily_deploy_aluminium > 0 } 
			}
		}
	}
	
	fuhrer_mana_self_state_powers = {
	
		context_type = selected_state_context
		
		window_name = "fuhrer_mana_self_state_powers_container"
		
		visible = {
			OR ={
				check_variable = { oil_deploy > 0 }
				check_variable = { rubber_deploy > 0 }
				check_variable = { steel_deploy > 0 }
				check_variable = { aluminium_deploy > 0 }
				check_variable = { chromium_deploy > 0 }
				check_variable = { tungsten_deploy > 0 }
			}	
		}
		
		effects = {
			
		}
		
		triggers = {
			
		}
		
		
	}
	
	fuhrer_mana_self_state_powers_2 = {
	
		context_type = selected_state_context
		
		window_name = "fuhrer_mana_self_state_powers_container_2"
		
		visible = {
			check_variable = { show_modifier = 1 }
		}
		
		effects = {
			exitbutton_click = {
				set_variable = { show_modifier = 0 } 
			}
			test_2_click = {
				subtract_from_variable = { Root.dx = 300 }
				set_state_flag = supply_flag
				set_variable = { var = state_modifier value = 90 }
				add_state_modifier = {
					modifier = {
						local_supplies = 0.5
					}
				}
			}
			test_3_click = {
				subtract_from_variable = { Root.dx = 500 }
				set_state_flag = resource_flag
				set_variable = { var = state_modifier value = 90 }
				add_state_modifier = {
					modifier = {
						local_resources = 0.3
					}
				}
			}
			test_4_click = {
				subtract_from_variable = { Root.dx = 250 }
				set_state_flag = recruitment_flag
				set_variable = { var = state_modifier value = 90 }
				add_state_modifier = {
					modifier = {
						local_manpower = 0.2
					}
				}
			}
			test_5_click = {
				subtract_from_variable = { Root.dx = 150 }
				set_state_flag = secrecy_flag
				set_variable = { var = state_modifier value = 90 }
				add_state_modifier = {
					modifier = {
						local_intel_to_enemies = -1
					}
				}
			}
			test_6_click = {
				subtract_from_variable = { Root.dx = 200 }
				set_state_flag = security_flag
				set_variable = { var = state_modifier value = 90 }
				add_state_modifier = {
					modifier = {
						local_factory_sabotage = -0.5
					}
				}
			}
			test_7_click = {
				subtract_from_variable = { Root.dx = 100 }
				set_state_flag = slots_flag
				add_state_modifier = {
					modifier = {
						local_building_slots_factor = 0.25
					}
				}
			}
			test_8_click = {
				subtract_from_variable = { Root.dx = 250 }
				set_state_flag = attrition_flag
				set_variable = { var = state_modifier value = 90 }
				add_state_modifier = {
					modifier = {
						attrition = -0.25
					}
				}
			}
			test_9_click = {
				subtract_from_variable = { Root.dx = 125 }
				set_state_flag = occupation_flag
				set_variable = { var = state_modifier value = 90 }
				add_state_modifier = {
					modifier = {
						occupation_cost = 0.02
						resistance_tick = -0.2
					}
				}
			}
			test_10_click = {
				subtract_from_variable = { Root.dx = 75 }
				set_state_flag = damage_factories_flag
				set_variable = { var = state_modifier value = 90 }
				add_state_modifier = {
					modifier = {
						local_factories = -1
					}
				}
			}
			test_11_click = {
				subtract_from_variable = { Root.dx = 50 }
				set_state_flag = resistance_flag
				set_variable = { var = state_modifier value = 90 }
				add_state_modifier = {
					modifier = {
						resistance_tick = 0.25
					}
				}
			}
			test_12_click = {
				subtract_from_variable = { Root.dx = 15 }
				clear_variable = state_modifier 
				clr_state_flag = supply_flag 
				clr_state_flag = resource_flag 
				clr_state_flag = recruitment_flag 
				clr_state_flag = secrecy_flag 
				clr_state_flag = security_flag 
				clr_state_flag = attrition_flag 
				clr_state_flag = occupation_flag 
				clr_state_flag = damage_factories_flag 
				clr_state_flag = resistance_flag 
			}
		}
		
		triggers = {
			test_2_click_enabled = {
				NOT = { has_state_flag = supply_flag }
				NOT = { has_state_flag = resource_flag }
				NOT = { has_state_flag = recruitment_flag }
				NOT = { has_state_flag = secrecy_flag }
				NOT = { has_state_flag = security_flag }
				NOT = { has_state_flag = attrition_flag }
				NOT = { has_state_flag = occupation_flag }
				NOT = { has_state_flag = damage_factories_flag }
				NOT = { has_state_flag = resistance_flag }
			}
			test_3_click_enabled = {
				NOT = { has_state_flag = supply_flag }
				NOT = { has_state_flag = resource_flag }
				NOT = { has_state_flag = recruitment_flag }
				NOT = { has_state_flag = secrecy_flag }
				NOT = { has_state_flag = security_flag }
				NOT = { has_state_flag = attrition_flag }
				NOT = { has_state_flag = occupation_flag }
				NOT = { has_state_flag = damage_factories_flag }
				NOT = { has_state_flag = resistance_flag }
				OR = {
					has_resources_amount = { resource = oil amount > 0 }
					has_resources_amount = { resource = rubber amount > 0 }
					has_resources_amount = { resource = steel amount > 0 }
					has_resources_amount = { resource = aluminium amount > 0 }
					has_resources_amount = { resource = tungsten amount > 0 }
					has_resources_amount = { resource = chromium amount > 0 }
				}
			}
			test_4_click_enabled = {
				NOT = { has_state_flag = supply_flag }
				NOT = { has_state_flag = resource_flag }
				NOT = { has_state_flag = recruitment_flag }
				NOT = { has_state_flag = secrecy_flag }
				NOT = { has_state_flag = security_flag }
				NOT = { has_state_flag = attrition_flag }
				NOT = { has_state_flag = occupation_flag }
				NOT = { has_state_flag = damage_factories_flag }
				NOT = { has_state_flag = resistance_flag }
			}
			test_5_click_enabled = {
				NOT = { has_state_flag = supply_flag }
				NOT = { has_state_flag = resource_flag }
				NOT = { has_state_flag = recruitment_flag }
				NOT = { has_state_flag = secrecy_flag }
				NOT = { has_state_flag = security_flag }
				NOT = { has_state_flag = attrition_flag }
				NOT = { has_state_flag = occupation_flag }
				NOT = { has_state_flag = damage_factories_flag }
				NOT = { has_state_flag = resistance_flag }
			}
			test_6_click_enabled = {
				NOT = { has_state_flag = supply_flag }
				NOT = { has_state_flag = resource_flag }
				NOT = { has_state_flag = recruitment_flag }
				NOT = { has_state_flag = secrecy_flag }
				NOT = { has_state_flag = security_flag }
				NOT = { has_state_flag = attrition_flag }
				NOT = { has_state_flag = occupation_flag }
				NOT = { has_state_flag = damage_factories_flag }
				NOT = { has_state_flag = resistance_flag }
				NOT = {	is_owned_by = ROOT }
				is_controlled_by = ROOT
			}
			test_7_click_enabled = {
				NOT = { has_state_flag = slots_flag }
			}
			test_8_click_enabled = {
				NOT = { has_state_flag = supply_flag }
				NOT = { has_state_flag = resource_flag }
				NOT = { has_state_flag = recruitment_flag }
				NOT = { has_state_flag = secrecy_flag }
				NOT = { has_state_flag = security_flag }
				NOT = { has_state_flag = attrition_flag }
				NOT = { has_state_flag = occupation_flag }
				NOT = { has_state_flag = damage_factories_flag }
				NOT = { has_state_flag = resistance_flag }
			}
			test_9_click_enabled = {
				NOT = { has_state_flag = supply_flag }
				NOT = { has_state_flag = resource_flag }
				NOT = { has_state_flag = recruitment_flag }
				NOT = { has_state_flag = secrecy_flag }
				NOT = { has_state_flag = security_flag }
				NOT = { has_state_flag = attrition_flag }
				NOT = { has_state_flag = occupation_flag }
				NOT = { has_state_flag = damage_factories_flag }
				NOT = { has_state_flag = resistance_flag }
				is_controlled_by = ROOT
				NOT = { is_owned_by = ROOT }
			}
			test_10_click_enabled = {
				NOT = { has_state_flag = supply_flag }
				NOT = { has_state_flag = resource_flag }
				NOT = { has_state_flag = recruitment_flag }
				NOT = { has_state_flag = secrecy_flag }
				NOT = { has_state_flag = security_flag }
				NOT = { has_state_flag = attrition_flag }
				NOT = { has_state_flag = occupation_flag }
				NOT = { has_state_flag = damage_factories_flag }
				NOT = { has_state_flag = resistance_flag }
				is_controlled_by = ROOT
				is_owned_by = ROOT
				NOT = { is_fully_controlled_by = ROOT }
			}
			test_11_click_enabled = {
			NOT = { has_state_flag = supply_flag }
				NOT = { has_state_flag = resource_flag }
				NOT = { has_state_flag = recruitment_flag }
				NOT = { has_state_flag = secrecy_flag }
				NOT = { has_state_flag = security_flag }
				NOT = { has_state_flag = attrition_flag }
				NOT = { has_state_flag = occupation_flag }
				NOT = { has_state_flag = damage_factories_flag }
				NOT = { has_state_flag = resistance_flag }
				set_temp_variable = { resistance_check = resistance }
				check_variable { resistance_check > 0 }
			}
			test_12_click_enabled = {
				OR = {
					has_state_flag = supply_flag 
					has_state_flag = resource_flag 
					has_state_flag = recruitment_flag 
					has_state_flag = secrecy_flag 
					has_state_flag = security_flag 
					has_state_flag = attrition_flag 
					has_state_flag = occupation_flag 
					has_state_flag = damage_factories_flag 
					has_state_flag = resistance_flag 
				}
			}
			active_supply_visible = {
				has_state_flag = supply_flag
			}
			active_resources_visible = {
				has_state_flag = resource_flag
			}
			active_recruitment_visible = {
				has_state_flag = recruitment_flag
			}
			active_secrecy_visible = {
				has_state_flag = secrecy_flag
			}
			active_security_visible = {
				has_state_flag = security_flag
			}
			active_attrition_visible = {
				has_state_flag = attrition_flag
			}
			active_occupation_visible = {
				has_state_flag = occupation_flag
			}
			active_factories_visible = {
				has_state_flag = damage_factories_flag
			}
			active_partisan_visible = {
				has_variable = resistance_flag
			}
			modifier_countdown_visible = {
				has_variable = state_modifier
			}
		}
	}  
	
	fuhrer_mana_self_state_powers_3 = {
	
		context_type = selected_state_context
		
		window_name = "fuhrer_mana_self_state_powers_container_3"
		
		visible = {
			is_controlled_by = ROOT
			ROOT = { has_country_flag = money }
		}
		
		effects = {
			button_speedstep1_click = {
				set_variable = { manual_taxes = 1 }
			}
			button_speedstep1_click = {
				set_variable = { manual_taxes = 2 }
			}
			button_speedstep1_click = {
				set_variable = { manual_taxes = 3 }
			}
			button_speedstep1_click = {
				set_variable = { manual_taxes = 4 }
			}
			button_speedstep1_click = {
				set_variable = { manual_taxes = 5 }
			}
			tax_plus_button_click = {
				if = {
					limit = {
						NOT = { has_variable = manual_taxes }
					}
					set_variable = { manual_taxes = 1 }
				}
				else_if = {
					limit = {
						check_variable = { manual_taxes < 5 }
					}
					add_to_variable = { manual_taxes = 1 }
				}
			}
			tax_minus_button_click = {
				if = {
					limit = {
						check_variable = { manual_taxes = 1 }
					}
					clear_variable = manual_taxes
					else = {
						subtract_from_variable = { manual_taxes = 1 }
					}
				}
			}
			button5_click = {
				if = {
					limit={
						check_variable = { show_modifier = 0 }
					}
					set_variable = { show_modifier = 1 }
					else ={
						set_variable = { show_modifier = 0 }
					}
				}
            }
			button4_click = {
				if = {
					limit={
						check_variable = { show_country_states = 0 }
					}
					set_variable = { show_country_states = 1 }
					else ={
						set_variable = { show_country_states = 0 }
					}
				}
			}
		}
		
		triggers = {
			wasteland_visible = {
				has_state_category = wasteland
			}
			enclave_visible = {
				has_state_category = enclave
			}
			tiny_island_visible = {
				has_state_category = tiny_island
			}
			small_island_visible = {
				has_state_category = small_island
			}
			pastoral_visible = {
				has_state_category = pastoral
			}
			rural_visible = {
				has_state_category = rural
			}
			town_visible = {
				has_state_category = town
			}
			large_town_visible = {
				has_state_category = large_town
			}
			city_visible = {
				has_state_category = city
			}
			large_city_visible = {
				has_state_category = large_city
			}
			metropolis_visible = {
				has_state_category = metropolis
			}
			megalopolis_visible = {
				OR = {
					has_state_category = megalopolis
					has_state_category = berlin
				}
			}
			huge_megalopolis_visible = {
				has_state_category = huge_megalopolis
			}
			tax_minimal_visible = {
				if = {
					limit = {
						NOT = { has_variable = manual_taxes }
					}
					ROOT = { has_idea = tax_minimal }
					else = {
						check_variable = { manual_taxes = 1 }
					}
				}
			}
			tax_low_visible = {
				if = {
					limit = {
						NOT = { has_variable = manual_taxes }
					}
					ROOT = { has_idea = tax_low }
					else = {
						check_variable = { manual_taxes = 2 }
					}
				}
			}
			tax_average_visible = {
				if = {
					limit = {
						NOT = { has_variable = manual_taxes }
					}
					ROOT = { has_idea = tax_average }
					else = {
						check_variable = { manual_taxes = 3 }
					}
				}
			}
			tax_high_visible = {
				if = {
					limit = {
						NOT = { has_variable = manual_taxes }
					}
					ROOT = { has_idea = tax_high }
					else = {
						check_variable = { manual_taxes = 4 }
					}
				}
			}
			tax_extreme_visible = {
				if = {
					limit = {
						NOT = { has_variable = manual_taxes }
					}
					ROOT = { has_idea = tax_extreme }
					else = {
						check_variable = { manual_taxes = 5 }
					}
				}
			}
			tax_minus_button_click_enabled = {
				check_variable = { manual_taxes > 0 }
			}
			tax_plus_button_click_enabled = {
				check_variable = { manual_taxes < 5 }
			}
				
		}
	}  
	
	fuhrer_mana_self_state_powers_4 = {
	
		context_type = selected_state_context
		
		window_name = "fuhrer_mana_self_state_powers_container_4"
		
		visible = {
			check_variable = { show_country_states = 1 }
		}
		
		effects = {
			exitbutton_click = {
				set_variable = { show_country_states = 0 }
			}
		}
		
		triggers = {
			
		}
	}  
}

